{{#if statusFetching}}
  <i class="icon icon-spinner icon-spin"></i>
{{else}}
  <div class="pt-20"></div>
  <div class="inline-form">
    <label>{{t 'newPipelineStep.stepType.scm.user'}}{{field-required}}</label>
    <div class="pt-10"></div>
    {{#if accountsInfo}}
    <div class="row">
      <div class="col span-12">
        {{#identity-block 
          principal=profileComponent
          link=false
        }}
        {{/identity-block}}
      </div>
      {{!-- <div class="col span-4 text-right">
        <button class="btn bg-primary"
        {{action "setState" "Oauth" true}}
        data-ember-action="" data-ember-action-2540="2540">
          <i class="icon icon-github"></i> Change User
      </button>
      </div> --}}
    </div>
    {{else}}
      <div class="row">
        <button class="btn bg-primary"
        {{action "authenticate"}}
        >
          <i class="icon icon-github"></i> {{t 'generic.loginIn'}}
        </button>
      </div>
    {{/if}}
  </div>

  <div class="pt-20"></div>
  <div class="inline-form">
    <label>
      {{t 'pipelineHistories.repository'}}{{field-required}} 
      {{#if (not-eq modalOpts.type 'review')}}
      {{#unless state.repoRefresh}}
        {{#tooltip-element 
        type="tooltip-basic"
        model='Refresh repository'
        tooltipTemplate='tooltip-static'
        aria-describedby="tooltip-base"
        tooltipFor="audit-log"}}
        <button {{action "reloadRepo"}} class="btn bg-transparent"><i class="icon icon-refresh"></i></button>
        {{/tooltip-element}}
      {{/unless}}
      {{/if}}
    </label>
    <div class="pt-10"></div>
    {{#if (eq modalOpts.type 'review')}}
      {{input class="form-control" value=selectedModel.sourceCodeConfig.url disabled=(if (eq modalOpts.type 'review') true false)}}
    {{else}}
      {{#if state.repoRefresh}}
        <i class="icon icon-spinner icon-spin"></i>
      {{else}}
        {{searchable-select
          content=repositories
          value=selectedModel.sourceCodeConfig.url 
          optionLabelPath="url"
          optionValuePath="url"
          readOnly=readOnly
        }}
      {{/if}}
    {{/if}}
  </div>
  <div class="pt-20"></div>
  <div class="inline-form">
    <label>{{t 'newPipelineStep.stepType.scm.branch'}}{{field-required}}</label>
    <div class="pt-10"></div>
    {{#each branchTypes as |type| }}
      <div class="pipeline-input-group">
        <div class="label-wrap">
          {{radio-button disabled=(if (eq modalOpts.type 'review') true false) id=type.value selection=selectedModel.sourceCodeConfig.branchCondition value=type.value}}
          <label for={{type.value}}>
            {{type.label}}
          </label>
        </div>
        {{#if (not-eq type.value 'all')}}
          <div class="input-wrap">
            {{input class="form-control js-disable-hint js-auto-focus" value=selectedModel.sourceCodeConfig.branch placeholder="master" disabled=(if (eq modalOpts.type 'review') true (if (eq type.value selectedModel.sourceCodeConfig.branchCondition) false true))}}
          </div>
        {{/if}}
        </div>
      <div class="mb-10"></div>
    {{/each}}

  </div>
  <div class="pt-10"></div>
  {{#pipeline-trigger
    selectedModel=selectedModel
    modalOpts=modalOpts
    disabled=(if (eq modalOpts.type 'review') true false)
    }}
  {{/pipeline-trigger}}
{{/if}}
