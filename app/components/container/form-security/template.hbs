{{#accordion-row
  title=(t 'formSecurity.title')
  detail=(t 'formSecurity.detail' appName=settings.appName)
  status=status
  statusClass=statusClass
}}
  <div class="row">
    <div class="col span-12 radio r-mb0">
      <label>{{t 'formSecurity.pullImage.label'}}</label>
      {{#if editing}}
        <div class="radio small mt-10">
          <label>{{radio-button selection=pullImage value=false}} {{t 'formSecurity.pullImage.disable'}}</label>
        </div>
        <div class="radio small mt-10">
          <label>{{radio-button selection=pullImage value=true}} {{t 'formSecurity.pullImage.enable'}}</label>
        </div>
      {{else}}
      {{/if}}
    </div>
  </div>

  {{#if projects.current.isWindows}}
    <div class="row">
      <div class="col span-12 col-inline">
        <label>{{t 'formSecurity.isolation.label'}}</label>
        {{#input-or-display editable=editing value=instance.isolation}}
          {{new-select
            classNames="form-control"
            content=isolationChoices
            localizedLabel=true
            value=instance.isolation
          }}
        {{/input-or-display}}
      </div>
    </div>
  {{else}}
    <div class="row">
      <div class="col span-6 col-inline">
        <label>{{t 'formSecurity.privileged.label'}}</label>
        {{#input-or-display editable=editing value=instance.privileged}}
          <div class="radio small mt-10">
            <label>{{radio-button selection=instance.privileged value=false}} {{t 'formSecurity.privileged.disable'}}</label>
          </div>
          <div class="radio small mt-10">
            <label>{{radio-button selection=instance.privileged value=true}} {{t 'formSecurity.privileged.enable'}}</label>
          </div>
        {{/input-or-display}}
      </div>
      <div class="col span-6 col-inline">
        <label>{{t 'formSecurity.pidMode.label'}}</label>
        {{#input-or-display editable=editing value=pidHost}}
          <div class="radio small mt-10">
            <label>{{radio-button selection=pidHost value=false}} {{t 'formSecurity.pidMode.disable'}}</label>
          </div>
          <div class="radio small mt-10">
            <label>{{radio-button selection=pidHost value=true}} {{t 'formSecurity.pidMode.enable'}}</label>
          </div>
        {{/input-or-display}}
      </div>
    </div>

    <div class="row">
      <div class="col span-2 col-inline">
        <label>{{t 'formSecurity.memoryLimit.label'}}</label>
      </div>
      <div class="col span-3">
        {{#input-or-display editable=editing value=memoryMb}}
          <div class="input-group">
            {{input-integer min="4" step="1" value=memoryMb classNames="form-control" placeholder=(t 'formSecurity.memoryLimit.placeholder')}}
            <div class="input-group-addon bg-default">{{t 'formSecurity.memoryLimit.mb'}}</div>
          </div>
        {{/input-or-display}}
      </div>
      <hr class="visible-xs-block visible-sm-block" />
      <div class="col span-2 col-inline">
        <label>{{t 'formSecurity.swapLimit.label'}}</label>
      </div>
      <div class="col span-3">
        {{#input-or-display editable=editing value=swapMb}}
          <div class="input-group">
            {{input-integer min="1" step="1" value=swapMb classNames="form-control" placeholder=(if memoryMb 'Requires Memory Limit' 'Unlimited') disabled=(not memoryMb)}}
            <div class="input-group-addon bg-default">{{t 'formSecurity.swapLimit.mb'}}</div>
          </div>
        {{/input-or-display}}
      </div>
    </div>
    <div class="row">
      <div class="col span-2 col-inline">
        <label>{{t 'formSecurity.memoryReservation.label'}}</label>
      </div>
      <div class="col span-3">
        {{#input-or-display editable=editing value=memoryReservationMb}}
          <div class="input-group">
            {{input-integer min="4" step="1" value=memoryReservationMb classNames="form-control" placeholder=(t 'formSecurity.memoryLimit.placeholder')}}
            <div class="input-group-addon bg-default">{{t 'formSecurity.memoryLimit.mb'}}</div>
          </div>
        {{/input-or-display}}
      </div>
      <hr class="visible-xs-block visible-sm-block" />
      <div class="col span-2 col-inline">
        <label>{{t 'formSecurity.milliCpuReservation.label'}}</label>
      </div>
      <div class="col span-3">
        {{#input-or-display editable=editing value=instance.milliCpuReservation}}
          <div class="input-group">
            {{input-integer min="1" step="1" value=instance.milliCpuReservation classNames="form-control"}}
          </div>
        {{/input-or-display}}
      </div>
    </div>

    <div class="row">
      <div class="col span-2 col-inline">
        <label>{{t 'formSecurity.cpuPinning.label'}}</label>
      </div>

      <div class="col span-3">
        {{#input-or-display editable=editing value=instance.cpuSet}}
          {{input type="text" value=instance.cpuSet classNames="form-control" placeholder=(t 'formSecurity.cpuPinning.placeholder')}}
        {{/input-or-display}}
      </div>
      <hr class="visible-xs-block visible-sm-block" />
      <div class="col span-2 col-inline">
        <label>{{t 'formSecurity.shares.label'}}</label>
      </div>
      <div class="col span-3">
        {{#input-or-display editable=editing value=instance.cpuShares}}
          {{input-integer value=instance.cpuShares step=128 min=0 classNames="form-control" placeholder=(t 'formSecurity.shares.placeholder')}}
        {{/input-or-display}}
      </div>
    </div>
    <div class="row">
      <div class="col span-2 col-inline">
        <label>{{t 'formSecurity.capabilities.label'}}{{#unless editing}}({{t 'formSecurity.capabilities.add'}}){{/unless}}</label>
      </div>

      <div class="col-sm-12 {{if editing "col-md-4" "col-md-3"}}">
        {{#if editing}}
          <select class="form-control select-cap-add" multiple="true" onchange={{action 'modifyCapabilities' 'capAdd' }}>
            {{#each capabilityChoices as |choice|}}
              <option value={{choice}} selected={{include instance.capAdd choice}}>{{choice}}</option>
            {{/each}}
          </select>
        {{else}}
          {{#if instance.capAdd}}
            {{#each instance.capAdd as |choice index|}}
              {{if index ", "}} {{choice}}
            {{/each}}
          {{else}}
            <div>{{t 'generic.none'}}</div>
          {{/if}}
        {{/if}}
      </div>
      <hr class="visible-xs-block visible-sm-block" />
      {{#unless editing}}
      <div class="col span-2 col-inline">
        <label>{{t 'formSecurity.capabilities.label'}}({{t 'formSecurity.capabilities.drop'}})</label>
      </div>
      {{/unless}}

      <div class="col span-4">
        {{#if editing}}
          <select class="form-control select-cap-drop" multiple="true" onchange={{action 'modifyCapabilities' 'capDrop'}}>
            {{#each capabilityChoices as |choice|}}
              <option value={{choice}} selected={{include instance.capDrop choice}}>{{choice}}</option>
            {{/each}}
          </select>
        {{else}}
          {{#if instance.capDrop}}
            {{#each instance.capDrop as |choice index|}}
              {{if index ", "}} {{choice}}
            {{/each}}
          {{else}}
            <div>{{t 'generic.none'}}</div>
          {{/if}}
        {{/if}}
      </div>
    {{#if editing}}
      <div class="row">
        <div class="col span-8 offset-2">
          <span class="text-info">
            {{t 'formSecurity.capabilities.helpBlock.text'}}
            <a href="http://man7.org/linux/man-pages/man7/capabilities.7.html" target="_blank">{{t 'formSecurity.capabilities.helpBlock.link'}}</a>
          </span>
        </div>
      </div>
    {{/if}}
    </div>

    <div class="row">
      <div class="col span-2 col-inline">
        <label>{{t 'formSecurity.deviceBinding.label'}}</label>
      </div>

      <div class="col span-8">
        {{#if editing}}
          <div>
            <button class="btn bg-link icon-btn" {{action "addDevice"}}>
              <i class="icon icon-plus text-small"/> 
              <span>{{t 'formSecurity.deviceBinding.addActionLabel'}}</span>
            </button>
          </div>
          {{#if devicesArray.length}}
            <table class="table fixed no-lines no-top-padding">
              <tr class="text-muted">
                <th>{{t 'formSecurity.deviceBinding.pathHost.label'}}</th>
                <th width="30">&nbsp;</th>
                <th>{{t 'formSecurity.deviceBinding.pathContainer.label'}}</th>
                <th width="30">&nbsp;</th>
                <th width="200">{{t 'formSecurity.deviceBinding.permissions.label'}}</th>
                <th width="30">&nbsp;</th>
              </tr>
              {{#each devicesArray as |device|}}
                <tr>
                  <td>
                    {{input class="form-control input-sm device-host" type="text" value=device.host placeholder=(t 'formSecurity.deviceBinding.pathHost.placeholder')}}
                  </td>
                  <td style="text-align: center">
                    <p class="input-sm"><i class="icon icon-chevron-right"></i></p>
                  </td>
                  <td>
                    {{input class="form-control input-sm" type="text" value=device.container placeholder=(t 'formSecurity.deviceBinding.pathContainer.placeholder')}}
                  </td>
                  <td>&nbsp;</td>
                  <td>
                    {{device-permissions buttonClass="btn-sm" initialSelection=device.permissions changed=(action (mut device.permissions))}}
                  </td>
                  <td class="text-right">
                    <button class="btn bg-primary btn-sm" {{action "removeDevice" device}}><i class="icon icon-minus"/></button>
                  </td>
                </tr>
              {{/each}}
            </table>
          {{/if}}
        {{else}}
          {{#if devicesArray.length}}
            <table class="table fixed no-lines no-top-padding">
              <tr class="text-muted">
                <th>{{t 'formSecurity.deviceBinding.pathHost.label'}}</th>
                <th width="30">&nbsp;</th>
                <th>{{t 'formSecurity.deviceBinding.pathContainer.label'}}</th>
                <th width="30">&nbsp;</th>
                <th width="100">{{t 'formSecurity.deviceBinding.permissions.label'}}</th>
                <th width="30">&nbsp;</th>
              </tr>
              {{#each devicesArray as |device|}}
                <tr>
                  <td>
                    {{device.host}}
                  </td>
                  <td style="text-align: center">
                    <p class="input-sm pt-10"><i class="icon icon-chevron-right"></i></p>
                  </td>
                  <td>
                    {{device.container}}
                  </td>
                  <td>&nbsp;</td>
                  <td>
                    {{device-permissions buttonClass="btn-sm" initialSelection=device.permissions changed=(action (mut device.permissions)) editing=editing}}
                  </td>
                  <td class="text-right">
                    &nbsp;
                  </td>
                </tr>
              {{/each}}
            </table>
          {{else}}
            <div>{{t 'generic.none'}}</div>
          {{/if}}
        {{/if}}
      </div>
    </div>
  {{/if}}
{{/accordion-row}}
